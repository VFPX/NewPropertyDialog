
<html>
<head>
<topictype value="TOPIC"/>
<title>How it Works</title>
<LINK rel="stylesheet" type="text/css" href="templates/wwhelp.css">
<SCRIPT SRC="templates/wwhelp.js"></SCRIPT>
</head>
<body leftmargin=0 topmargin=0>

<table border=0 width="100%" bgcolor="lightblue" class="banner" cellspacing="3">
<tr><td valign="center">
<span class="projectname">New Property/Method Dialog Replacement</span>
</td></tr><tr><td>
<span class="topicname">How it Works
</span>
</td></tr>
</table>

<div class="contentpane">
<br>Like the replacement New Property/Method dialog, the replacement Edit Property/Method dialog replies on a new feature added to VFP 9 that allows us to override an existing Visual FoxPro shortcut menu. This feature, called MENUCONTEXT, is implemented in a very similar mechanism to <a href="_1t5108g4r.htm" >MENUHIT</a>.<p>The code for the MENUCONTEXT script must accept a single object as a parameter. This object has two properties that are used to provide the behavior required. The UserTyped property contains the name of the property or method that the user right-clicked in the property sheet. The replacement dialog uses this to automatically select the correct member in the grid. A second property, MenuItem, is the menu ID for the shortcut menu. The menu ID for the Properties Window is 24460. A record of type M must be added to the FoxCode table with an Abbrev of 24460 to handle the shortcut menu. This script sets the ValueType to "V" and returns .T. to prevent the native behavior from happening.<p>A third property of the parameter object, Items, contains an array of all the menu items displayed on the context sensitive menu. However, it is pretty useless when building a replacement because changing them does not change the display of the menu. Even more important, there is no way to change what happens when a menu item is selected. So, the script has to construct its own shortcut menu.<p>Detailed information on this subject can be found in Doug Hennig's article, "Extending the VFP 9 IDE with MENUHIT and MENUCONTEXT", available at <a href="http://msdn2.microsoft.com/en-us/library/ms947606.aspx" target="top">http://msdn2.microsoft.com/en-us/library/ms947606.aspx</a>.
<br>

<p>
</div>
<hr>
<small>Last Updated: <i>11/21/2007</i></small>
</body>
</html>